---
title: "ğŸŒ¿ksnctf#2 writeup"
date: 2023-07-10
---

[ksnctf](https://ksnctf.sweetduet.info/)ã‚’ã¡ã‚‡ã£ã¨ãšã¤é€²ã‚ã‚ˆã†ã¨æ€ã†ã€‚writeupã®å…¬é–‹ã¯OKã¨ã®ã“ã¨ãªã®ã§è§£æ³•ã‚’æ›¸ã„ã¦ã„ãã€‚

# **Easy Cipher**

ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã®ç¾…åˆ—ãŒä¸ãˆã‚‰ã‚Œã‚‹ã€‚ã‚¿ã‚¤ãƒˆãƒ«ã‹ã‚‰ä½•ã‹ã—ã‚‰ã®æš—å·æ–‡ã¨ã‚ã‹ã‚‹ã€‚

Amazonã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆã®ãƒ‹ã‚³ãƒ‹åºƒå‘Šã¿ãŸã„ã®ãŒä¸‹ã«ã‚ã£ã¦ã€ã‚«ã‚¨ã‚µãƒ«ã£ã¦æœ¬ãŒç™»éŒ²ã•ã‚Œã¦ãŸã€‚ã‚·ãƒ¼ã‚¶ãƒ¼æš—å·ãªã®ã‹ãªâ€¦ã€‚

Rubyã«ã¯`String#tr`ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã£ã¦ã‚·ãƒ¼ã‚¶ãƒ¼æš—å·ã®è§£èª­ã«ã¡ã‚‡ã†ã©è‰¯ã„æ„Ÿã˜ï¼ˆ`String#next`ã¯ä½¿ãˆãªã„ã­ï¼‰ã€‚

å‚è€ƒ

[String#tr (Ruby 3.0 ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ãƒãƒ‹ãƒ¥ã‚¢ãƒ«)](https://docs.ruby-lang.org/ja/3.0/method/String/i/tr.html)

vfã¯isã£ã½ã„ãªã¨ã„ã†äºˆæƒ³ã‹ã‚‰ã€irbã‚’é–‹ãè©¦ã—ã¦ã„ã‚‹ã¨ã“ã‚Œã§isãŒç¾ã‚Œã‚‹ã€‚

```ruby
"vf".tr("a-z", "n-za-m")
=> "is"
```

å¤‰æ›ã®ä»•æ–¹ãŒã‚ã‹ã£ãŸã®ã§ã€å•é¡Œæ–‡ã‚’å¾©å·ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã€‚

```ruby
ciphers = "EBG KVVV vf n fvzcyr yrggre fhofgvghgvba pvcure gung ercynprf n yrggre jvgu gur yrggre KVVV yrggref nsgre vg va gur nycunorg. EBG KVVV vf na rknzcyr bs gur Pnrfne pvcure, qrirybcrq va napvrag Ebzr. Synt vf SYNTFjmtkOWFNZdjkkNH. Vafreg na haqrefpber vzzrqvngryl nsgre SYNT."

res = ciphers.split.map do |cipher|
  cipher.split("").map { _1.tr("a-z", "n-za-m") }.join
end

print res.join(" ")

=> EBG KVVV is a simple letter substitution cipher that replaces a letter with the letter KVVV letters after it in the alphabet. EBG KVVV is an example of the Paesar cipher, developed in ancient Eome. Slag is SYNTFwzgxOWFNZqwxxNH. Vnsert an underscore immediately after SYNT.â
```

â€¦å¤§æ–‡å­—ãŒæ‹¾ãˆã¦ãªã„ã›ã„ã§å¾®å¦™ã«è§£èª­ã—ãã‚Œã¦ã„ãªã„ã€‚å¤§æ–‡å­—ã‚‚å¤‰æ›ã™ã‚‹ã‚ˆã†ã«`tr`ã‚’æ›¸ãç›´ã—ã€ä»¥ä¸‹ã§ã‚¯ãƒªã‚¢ã€‚

```ruby
ciphers = "EBG KVVV vf n fvzcyr yrggre fhofgvghgvba pvcure gung ercynprf n yrggre jvgu gur yrggre KVVV yrggref nsgre vg va gur nycunorg. EBG KVVV vf na rknzcyr bs gur Pnrfne pvcure, qrirybcrq va napvrag Ebzr. Synt vf SYNTFjmtkOWFNZdjkkNH. Vafreg na haqrefpber vzzrqvngryl nsgre SYNT."

res = ciphers.split.map do |cipher|
  cipher.split("").map { _1.tr("a-zA-Z", "n-za-mN-ZA-M") }.join
end

print res.join(" ")

=> ROT XIII is a simple letter substitution cipher that replaces a letter with the letter XIII letters after it in the alphabet. ROT XIII is an example of the Caesar cipher, developed in ancient Rome. Flag is ______________. Insert an underscore immediately after FLAG.â
```

## ãŠã¾ã‘

ã‚½ãƒ¼ã‚¹ãŒå¾®å¦™ã€‚

```ruby
# cipher"s"ãªã®ã§é…åˆ—ã‚’æ ¼ç´ã™ã‚‹
ciphers = "EBG KVVV vf n fvzcyr yrggre fhofgvghgvba pvcure gung ercynprf n yrggre jvgu gur yrggre KVVV yrggref nsgre vg va gur nycunorg. EBG KVVV vf na rknzcyr bs gur Pnrfne pvcure, qrirybcrq va napvrag Ebzr. Synt vf SYNTFjmtkOWFNZdjkkNH. Vafreg na haqrefpber vzzrqvngryl nsgre SYNT.".split

# mapã‚’ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã«ã™ã‚‹
results = []
ciphers.map { |cipher| cipher.split { results << _1.tr("a-zA-Z", "n-za-mN-ZA-M") } }

print results.join(" ")
```

â€¦2åº¦ã®`split`ãŒã‚¤ã‚±ã¦ãªã„ã®ã§â€¦

```ruby
ciphers = "EBG KVVV vf n fvzcyr yrggre fhofgvghgvba pvcure gung ercynprf n yrggre jvgu gur yrggre KVVV yrggref nsgre vg va gur nycunorg. EBG KVVV vf na rknzcyr bs gur Pnrfne pvcure, qrirybcrq va napvrag Ebzr. Synt vf SYNTFjmtkOWFNZdjkkNH. Vafreg na haqrefpber vzzrqvngryl nsgre SYNT.".split("")

print ciphers.map { _1.tr("a-zA-Z", "n-za-mN-ZA-M") }.join
```

ã“ã‚Œã§ã‚¹ãƒƒã‚­ãƒªğŸ†—
